CMAKE_MINIMUM_REQUIRED( VERSION 2.8)
PROJECT (PJACOBI Fortran)

INCLUDE_DIRECTORIES("${PROJECT_SOURCE_DIR}")
INCLUDE_DIRECTORIES("$ENV{VISITHOME}/current/linux-x86_64/libsim/V2/include")

LINK_DIRECTORIES("$ENV{VISITHOME}/current/linux-x86_64/libsim/V2/lib")

FIND_PACKAGE(MPI REQUIRED) 
INCLUDE_DIRECTORIES(${MPI_Fortran_INCLUDE_PATH})

SET(F90_SRCS
jacobi_module.f90
pjacobi.f90
)
SET_SOURCE_FILES_PROPERTIES(${F90_SRCS} PROPERTIES COMPILE_FLAGS "-cpp")

ADD_EXECUTABLE(pjacobi_visit simulationexamplev2.f ${F90_SRCS} PJacobi_InSitu.f)
TARGET_LINK_LIBRARIES(pjacobi_visit ${MPI_Fortran_LIBRARIES} simV2f.a simV2.a dl m)
SET_PROPERTY(TARGET pjacobi_visit APPEND PROPERTY COMPILE_FLAGS "-D_VISIT_")

ADD_EXECUTABLE(pjacobi ${F90_SRCS})
TARGET_LINK_LIBRARIES(pjacobi ${MPI_Fortran_LIBRARIES})

