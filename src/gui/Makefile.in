#                         Copyright (c) 2000 - 2006
#                 The Regents of the University of California
#            Produced at the Lawrence Livermore National Laboratory
#            Written by Sean Ahern, Kathleen Bonnell, Eric Brugger,
#           Hank Childs, Jeremy Meredith, Mark Miller, Brad Whitlock
#                              UCRL-CODE-220908
#                            All rights reserved.
#
# This file is part of VisIt. For details, see http://www.llnl.gov/visit/.
#
# Redistribution  and  use  in  source  and  binary  forms,  with  or  without
# modification, are permitted provided  that the following conditions are met:
#
# - Redistributions of  source code  must retain  the above  copyright notice,
#   this list of conditions and the disclaimer below.
# - Redistributions in binary form must  reproduce the above copyright notice,
#   this  list of  conditions  and  the  disclaimer  (as noted below)  in  the
#   documentation and/or materials provided with the distribution.
# - Neither the name of the  UC/LLNL nor the names of  its contributors may be
#   used to endorse  or promote products  derived from  this software  without
#   specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE  COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
# AND ANY EXPRESS OR  IMPLIED WARRANTIES,  INCLUDING, BUT NOT  LIMITED TO, THE
# IMPLIED WARRANTIES  OF MERCHANTABILITY AND FITNESS FOR  A PARTICULAR PURPOSE
# ARE  DISCLAIMED.  IN  NO  EVENT  SHALL  THE  REGENTS  OF  THE  UNIVERSITY OF
# CALIFORNIA, THE U.S. DEPARTMENT OF ENERGY  OR CONTRIBUTORS BE LIABLE FOR ANY
# DIRECT, INDIRECT,  INCIDENTAL, SPECIAL, EXEMPLARY, OR  CONSEQUENTIAL DAMAGES
# (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
# LOSS OF USE, DATA, OR PROFITS; OR  BUSINESS INTERRUPTION) HOWEVER CAUSED AND
# ON ANY THEORY OF  LIABILITY, WHETHER IN CONTRACT, STRICT  LIABILITY, OR TORT
# (INCLUDING  NEGLIGENCE OR  OTHERWISE) ARISING IN ANY  WAY OUT OF  THE USE OF
# THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
# Additional BSD Notice
#
# 1. This notice is required  to be provided under our  contract with the U.S.
#    Department of Energy  (DOE). This work was produced  at the University of
#    California,  Lawrence Livermore National  Laboratory  under Contract  No.
#    W-7405-ENG-48 with the DOE.
#
# 2. Neither the  United States Government  nor the  University of  California
#    nor any of their  employees, makes  any warranty, express  or implied, or
#    assumes any liability  or responsibility for the  accuracy, completeness,
#    or  usefulness  of  any  information,   apparatus,  product,  or  process
#    disclosed, or represents that its  use would not infringe privately-owned
#    rights.
#
# 3. Also, reference herein  to any specific commercial  products, process, or
#    services by trade  name, trademark,  manufacturer  or otherwise  does not
#    necessarily  constitute  or imply  its  endorsement,  recommendation,  or
#    favoring by the United States Government or the University of California.
#    The views and  opinions of authors  expressed herein  do not  necessarily
#    state or reflect those of the  United States Government or the University
#    of  California,  and  shall  not  be  used  for  advertising  or  product
#    endorsement purposes.
#
# Modifications:
#
#    Jeremy Meredith, Fri Aug  4 16:42:44 PDT 2000
#    Changed source listing to use SRC=$(OBJ:.o=.C).  This allows parsing
#    of this Makefile.in for object files inside configure.
#    Cleaned up some stuff, too.
#
#    Jeremy Meredith, Tue Aug  8 13:45:29 PDT 2000
#    Added shared .o files as dependencies of the binaries.  Also, added
#    targets for all the shared .o files to prevent trying to rebuild
#    them.  It cannot do it correctly automatically.
#
#    Jeremy Meredith, Mon Aug 14 10:16:09 PDT 2000
#    Added RPCs.
#
#    Jeremy Meredith, Tue Sep  5 13:08:29 PDT 2000
#    Made it use the MDServerProxy library instead of .o files.
#
#    Kathleen Bonnell, Tue Oct 10 14:25:23 PDT 2000
#    Added QvisOnionPeelWindow and moc_QvisOnionPeelWindow
#
#    Kathleen Bonnell, Tue Oct 17 14:52:16 PDT 2000 
#    Added target moc_QvisOnionPeelWindow.o .
#
#    Brad Whitlock, Mon Nov 13 10:50:31 PDT 2000
#    Added files for material plot window.
#
#    Jeremy Meredith, Fri Nov 17 16:26:24 PST 2000
#    Removed -lexception.
#
#    Eric Brugger, Wed Dec  6 12:52:52 PST 2000
#    I removed CXXFLAGS from the link line.
#
#    Brad Whitlock, Tue Dec 5 10:05:58 PDT 2000
#    Added new color selection widgets.
#
#    Brad Whitlock, Tue Dec 12 14:03:40 PST 2000
#    Added files for material selection.
#
#    Brad Whitlock, Wed Jan 3 09:46:29 PDT 2001
#    Added QvisSpectrumBar widget.
#
#    Hank Childs, Tue Jan 16 13:51:46 PST 2001
#    Added volume plot types.
#
#    Brad Whitlock, Fri Feb 9 17:32:41 PST 2001
#    Added QvisSaveWindow.
#
#    Brad Whitlock, Fri Feb 16 14:30:26 PST 2001
#    Added contour plot window.
#
#    Kathleen Bonnell, Tue Mar  6 13:40:59 PST 2001 
#    Added surface plot window.
#
#    Hank Childs, Thu Mar 15 08:18:59 PST 2001
#    Removed Silo library.
#
#    Eric Brugger, Tue Mar 13 10:16:37 PST 2001
#    I added a -lgplot -lplot to pick up the plot plugin libraries. I
#    moved all the source files having to do with plot attribute windows.
#
#    Jeremy Meredith, Wed Mar 28 14:07:51 PST 2001
#    Renamed -lplot to be a GUI specific set of plugins.
#
#    Brad Whitlock, Fri Mar 30 16:33:28 PST 2001
#    Removed pthreads and python libraries for now...
#
#    Jeremy Meredith, Fri Apr 27 15:41:00 PDT 2001
#    Swapped -lcomm and -lmisc.
#
#    Jeremy Meredith, Fri May 11 13:44:35 PDT 2001
#    Made all the .o's but the main one build a shared libgui library.
#    Removed python.
#
#    Hank Childs, Wed Jun 13 15:12:40 PDT 2001
#    Changed libmetadata to libdbatts.
#
#    Brad Whitlock, Mon Jun 11 10:16:28 PDT 2001
#    Added the colortable window.
#
#    Brad Whitlock, Sun Jun 17 20:16:52 PST 2001
#    Added the annotation window.
#
#    Brad Whitlock, Wed Jun 20 16:01:34 PST 2001
#    Added the subset window.
#
#    Hank Childs, Fri Jul 20 08:29:39 PDT 2001
#    Removed material select window.
#
#    Jeremy Meredith, Thu Jul 26 03:35:24 PDT 2001
#    Added support for operator plugins.  Moved operator windows out of here.
#
#    Brad Whitlock, Thu Jul 26 15:58:05 PST 2001
#    Added the view window.
#
#    Jeremy Meredith, Fri Jul 27 13:47:16 PDT 2001
#    Added @PX@ to libplugin.  Made "make clean" remove gui.o.
#
#    Brad Whitlock, Mon Aug 27 11:53:58 PDT 2001
#    Added a new window base class.
#
#    Sean Ahern, Mon Aug 27 15:22:22 PDT 2001
#    Added automatic moc build rules.  Cleaned up the Makefile a bit.
#
#    Sean Ahern, Mon Aug 27 15:46:57 PDT 2001
#    Added a splash screen.
#
#    Jeremy Meredith, Tue Sep  4 10:34:25 PDT 2001
#    Changed library building: the LIB targets has no extension, and
#    either LIBSINGLETARGETS or LIBMULTITARGETS must be included
#    in addition to TARGETS depending on whether the library is build
#    from object files in one directory or multiple subdirectories.
#
#    Jeremy Meredith, Wed Sep  5 13:57:47 PDT 2001
#    Added QvisPluginWindow.
#
#    Brad Whitlock, Thu Sep 6 11:37:14 PDT 2001
#    Added appearance window.
#
#    Sean Ahern, Thu Sep 13 15:24:44 PDT 2001
#    Added the Expressions window.
#
#    Jeremy Meredith, Tue Sep 25 15:26:43 PDT 2001
#    Added WindowMetrics.
#
#    Sean Ahern, Fri Sep 28 13:57:16 PDT 2001
#    Added the ExpressionTable, ExprDeleteButton, and ExprTypeItem.
#
#    Brad Whitlock, Wed Oct 17 09:17:02 PDT 2001
#    Added the lighting window.
#
#    Kathleen Bonnell, Wed Oct 31 08:39:03 PST 2001 
#    Removed defunct '../plots/include' from CXXFLAGS. 
#
#    Eric Brugger, Mon Nov 19 14:56:45 PST 2001
#    Added the animation attributes window.
#
#    Kathleen Bonnell, Wed Dec 12 11:59:33 PST 2001 
#    Added pick window. 
#
#    Jeremy Meredith, Thu Jan  3 14:33:14 PST 2002
#    Fixed a couple targets.
#
#    Brad Whitlock, Mon Feb 4 15:50:12 PST 2002
#    Made it use libwinutil which now contains WindowMetrics.
#
#    Jeremy Meredith, Thu Feb 14 15:15:48 PST 2002
#    I added the utility library.
#
#    Brad Whitlock, Tue Feb 19 11:35:17 PDT 2002
#    Added the copyright window.
#
#    Jeremy Meredith, Mon Mar 11 16:50:46 PST 2002
#    Made splash screen directory lowercase.
#
#    Brad Whitlock, Fri Apr 12 12:44:07 PDT 2002
#    Added QvisOperatorWindow.
#
#    Brad Whitlock, Tue Mar 26 15:20:40 PST 2002
#    I removed the rpc library.
#
#    Jeremy Meredith, Wed May  8 15:19:43 PDT 2002
#    Added keyframe window.
#
#    Jeremy Meredith, Fri Jul 12 14:32:37 PDT 2002
#    Unified include directories.  Changed moc location.
#
#    Brad Whitlock, Thu Jul 11 17:17:40 PST 2002
#    Added help window and removed copyright window.
#
#    Brad Whitlock, Tue Aug 20 14:18:36 PST 2002
#    Added the file information window.
#
#    Brad Whitlock, Wed Sep 18 17:40:06 PST 2002
#    Added the rendering options window.
#
#    Brad Whitlock, Fri Sep 6 16:02:56 PST 2002
#    I added the query window.
#
#    Brad Whitlock, Mon Sep 30 10:50:31 PDT 2002
#    Added pthreads back to the GUI so that it can update when opening a
#    remote process.
#
#    Jeremy Meredith, Thu Oct 24 16:14:41 PDT 2002
#    Added material options window.
#
#    Jeremy Meredith, Thu Jan 23 17:16:17 PST 2003
#    Added Keyframing objects.
#
#    Jeremy Meredith, Fri Jan 31 09:44:59 PST 2003
#    KFBase and KFListViewItem weren't widgets, so I
#    put them with the other non-widget files.
#
#    Kathleen Bonnell, Mon Feb 3 13:57:29 PST 2003  
#    Added global lineout window.
#
#    Sean Ahern, Wed Feb  5 16:27:38 PST 2003
#    DBAtts uses the parser, so we need to include the library here.
#
#    Eric Brugger, Thu Mar 13 11:24:46 PST 2003
#    Added preferences window.
#
#    Brad Whitlock, Mon Mar 17 15:09:49 PST 2003
#    I removed QvisVariablePopupMenu since I moved it to the winutils library.
#
#    Brad Whitlock, Tue Apr 8 11:18:28 PDT 2003
#    I renamed some files.
#
#    Brad Whitlock, Fri May 2 15:52:18 PST 2003
#    I added libproxybase to the list of libs.
#
#    Brad Whitlock, Thu Jun 19 13:07:26 PST 2003
#    I made the splashscreen part of the GUI.
#
#    Brad Whitlock, Fri Oct 10 14:56:47 PST 2003
#    I added QvisRecentPathRemovalWindow.
#
#    Brad Whitlock, Thu Sep 4 10:16:28 PDT 2003
#    I added QvisApplication.
#
#    Jeremy Meredith, Wed Nov 19 12:35:43 PST 2003
#    Moved a few non-widget files from MOC to non-MOC status.
#
#    Kathleen Bonnell, Thu Nov 20 07:30:51 PST 2003 
#    Added the non-widgest files to SRC. 
#
#    Brad Whitlock, Fri Oct 31 13:32:19 PST 2003
#    I Added new files for advanced annotation controls.
#
#    Brad Whitlock, Tue Dec 30 14:28:20 PST 2003
#    I added QvisAnimationSlider.
#
#    Brad Whitlock, Fri Jan 30 18:07:28 PST 2004
#    I added NameSimplifier, QvisDatabaseCorrelationListWindow, and
#    QvisDatabaseCorrelationWindow.
#
#    Kathleen Bonnell, Wed Mar 31 10:22:47 PST 2004 
#    Added QvisQueryOverTimeWindow.
#
#    Brad Whitlock, Mon Apr 26 10:21:25 PDT 2004
#    I added support for MacOS X frameworks so the gui can be prebound on
#    MacOS X.
#
#    Brad Whitlock, Wed May 5 16:20:09 PST 2004
#    I removed the command line window and interpreter classes since they
#    have not been valid since before the intitial visit prototype.
#
#    Kathleen Bonnell, Mon Aug 16 17:54:35 PDT 2004 
#    Added QvisInteractorWindow.
#
#    Jeremy Meredith, Sun Oct 10 23:38:57 PDT 2004
#    Removed ExprTableItem, ExpressionTable, and ExprDeleteButton;
#    redesigned expressions window.
#
#    Kathleen Bonnell, Fri Nov 12 09:54:25 PST 2004 
#    Added QvisPointControl.
#
#    Jeremy Meredith, Tue Nov 23 14:53:07 PST 2004
#    Refactored the expression parser into two separate libraries.
#
#    Brad Whitlock, Fri Dec 3 14:20:39 PST 2004
#    Added QvisVariableButton, QvisWizard.
#
#    Brad Whitlock, Wed Feb 9 17:34:19 PST 2005
#    Added QvisVisItUpdate.
#
#    Brad Whitlock, Wed Mar 2 10:41:52 PDT 2005
#    Added QvisFtp so we can have FTP on pre 3.1 versions of Qt.
#
#    Jeremy Meredith, Mon Mar 21 12:57:07 PST 2005
#    Added QvisSimulationWindow.
#
#    Brad Whitlock, Tue Mar 22 10:23:43 PDT 2005
#    I added QvisSaveMovieWizard and QvisMovieProgressDialog.
#
#    Hank Childs, Tue May 24 17:11:00 PDT 2005
#    Added QvisExportDBWindow.
#
#    Brad Whitlock, Tue Jun 28 11:43:16 PDT 2005
#    Added John Anderson's QvisImageAnnotationInterface and
#    QvisLine2DInterface.
#
#    Mark C. Miller, Wed Nov 16 10:46:36 PST 2005
#    Added mesh management attributes window.
#
#    Shelly Prevost, Wed Nov 16 10:46:36 PST 2005
#    Added QUI_LIBS for dynamic ui loading.  Added SimCommandSlots.
#
#    Jeremy Meredith, Wed Aug  9 15:39:14 EDT 2006
#    Added QvisElementButton.  Refactored QvisColorGridWidget into
#    QvisGridWidget and added QvisPeriodicTableWidget.
#    Added QvisFileOpenWindow, and split out QFileSelectionListBoxItem
#    and QVirtualFileListBoxItem from QvisFileSelectionWindow.
#    Changed moc file builds to automatic rule so it picks up the
#    dependencies correctly.
#
##############################################################################

##
## Programs and options...
##
@SET_MAKE@
@VARIABLES@
LIB=libgui

LIBS=-lplugin $(QT_LIBS) $(QUI_LIBS) -L../lib -lviewerproxy -lviewerrpc \
     -lmdserverproxy -lmdserverrpc -ldbatts -lproxybase \
     -lmisc -lstate -lcomm -lavtexceptions -lutility -lexpr -lparser \
     -lwinutil $(X_LIBS) @LIBS@ @PTHREAD_LIB@ @GUIFRAMEWORKS@

LDFLAGS=@LDFLAGS@ @QT_LDFLAGS@
LIBDEP=
CXXFLAGS=-I. @CXXFLAGS@ @QT_CXXFLAGS@ -I../include/visit

MOC=@QT_MOC@

##
## Files...
##

# First, all of the header files that define Qt objects.
HDRMOC = \
    KFListView.h \
    KFTimeSlider.h \
    QvisAbstractOpacityBar.h \
    QvisAnimationSlider.h \
    QvisAnimationWindow.h \
    QvisAnnotationObjectInterface.h \
    QvisAnnotationWindow.h \
    QvisAppearanceWindow.h \
    QvisApplication.h \
    QvisCheckListManagerWidget.h \
    QvisColorButton.h \
    QvisColorGridWidget.h \
    QvisColorManagerWidget.h \
    QvisColorSelectionWidget.h \
    QvisColorTableButton.h \
    QvisColorTableWindow.h \
    QvisCommandWindow.h \
    QvisDatabaseCorrelationListWindow.h \
    QvisDatabaseCorrelationWindow.h \
    QvisDelayedWindow.h \
    QvisDelayedWindowObserver.h \
    QvisDelayedWindowSimpleObserver.h \
    QvisMeshManagementWindow.h \
    QvisElementButton.h \
    QvisEngineWindow.h \
    QvisExportDBWindow.h \
    QvisExpressionsWindow.h \
    QvisFileInformationWindow.h \
    QvisFilePanel.h \
    QvisFileSelectionWindow.h \
    QvisFileOpenWindow.h \
    QvisFtp.h \
    QvisGaussianOpacityBar.h \
    QvisGlobalLineoutWindow.h \
    QvisGridWidget.h \
    QvisGUIApplication.h \
    QvisHelpWindow.h \
    QvisHostProfileWindow.h \
    QvisImageAnnotationInterface.h \
    QvisInteractorWindow.h \
    QvisInterpreter.h \
    QvisKeyframeWindow.h \
    QvisLightingWidget.h \
    QvisLightingWindow.h \
    QvisLine2DInterface.h \
    QvisLineStyleWidget.h \
    QvisLineWidthWidget.h \
    QvisMainWindow.h \
    QvisMaterialWindow.h \
    QvisMessageWindow.h \
    QvisMovieProgressDialog.h \
    QvisNotepadArea.h \
    QvisOpacitySlider.h \
    QvisOperatorWindow.h \
    QvisOutputWindow.h \
    QvisPeriodicTableWidget.h \
    QvisPickWindow.h \
    QvisPlotListBox.h \
    QvisPlotManagerWidget.h \
    QvisPluginWindow.h \
    QvisPointControl.h \
    QvisPostableWindow.h \
    QvisPostableWindowObserver.h \
    QvisPostableWindowSimpleObserver.h \
    QvisPreferencesWindow.h \
    QvisQueryOverTimeWindow.h \
    QvisQueryWindow.h \
    QvisRecentPathRemovalWindow.h \
    QvisRenderingWindow.h \
    QvisSaveMovieWizard.h \
    QvisSaveWindow.h \
    QvisScreenPositionEdit.h \
    QvisScreenPositioner.h \
    QvisScribbleOpacityBar.h \
    QvisSessionFileDatabaseLoader.h \
    QvisSimulationWindow.h \
    QvisSpectrumBar.h \
    QvisSubsetListView.h \
    QvisSubsetWindow.h \
    QvisText2DInterface.h \
    QvisTimeSliderInterface.h \
    QvisTurnDownButton.h \
    QvisVariableButton.h \
    QvisVariableButtonHelper.h \
    QvisVCRControl.h \
    QvisViewWindow.h \
    QvisVisItUpdate.h \
    QvisWindowBase.h \
    QvisWizard.h \
    SimCommandSlots.h \
    SplashScreen.h

# Then, all of the rest of the header files
HDR = ${HDRMOC} \
    ColorTableObserver.h \
    FileServerList.h \
    GUIBase.h \
    KFBase.h \
    KFListViewItem.h \
    NameSimplifier.h \
    mini3D.h \
    QualifiedFilename.h \
    QvisListViewFileItem.h \
    QvisAnnotationObjectInterfaceFactory.h \
    QvisPlotListBoxItem.h \
    QvisSubsetListViewItem.h \
    StatusSubject.h

# All of the sources that are not Qt objects.
SRC = \
    ${HDRMOC:.h=.C} \
    ColorTableObserver.C \
    FileServerList.C \
    GUIBase.C \
    KFBase.C \
    KFListViewItem.C \
    NameSimplifier.C \
    mini3D.C \
    QualifiedFilename.C \
    QFileSelectionListBoxItem.C \
    QVirtualFileListBoxItem.C \
    QvisListViewFileItem.C \
    QvisPlotListBoxItem.C \
    QvisSubsetListViewItem.C \
    QvisAnnotationObjectInterfaceFactory.C \
    QvisHelpListViewItem.C

# Where main() is.
MAINSRC = main.C

SRCMOC=${HDRMOC:.h=_moc.C}
OBJMOC=${SRCMOC:.C=.o}

OBJ=$(SRC:.C=.o) ${OBJMOC}
MAINOBJ=$(MAINSRC:.C=.o)


DISTRIB=


##
## Standard targets...
##
all: message $(LIBSHARED) $(tmpbin)/gui

install: install_bin

clean:
	$(RM) $(OBJ) $(MAINOBJ) $(SRCMOC) $(LIBSHARED) $(tmpbin)/gui

##
## Other targets...
##
$(tmpbin)/gui: $(LIBDEP) $(MAINOBJ) $(LIBSHARED)
	$(CXX) -o $@ $(MAINOBJ) $(LDFLAGS) $(LIBS) -lgui

purify: $(LIBDEP) $(MAINOBJ) $(LIBSHARED)
	purify $(CXX) -o $(tmpbin)/gui $(MAINOBJ) $(LDFLAGS) $(LIBS) -lgui

quantify: $(LIBDEP) $(MAINOBJ) $(LIBSHARED)
	quantify $(CXX) -o $(tmpbin)/gui $(MAINOBJ) $(LDFLAGS) $(LIBS) -lgui


TESTOBJ=QvisColorSelectionWidget.C testmain.C
TESTOBJMOC=moc_QvisColorSelectionWidget.C

$(tmpbin)/test: $(LIBDEP) $(TESTOBJ) $(TESTOBJMOC)
	$(CXX) $(CXXFLAGS) -o $@ $(TESTOBJ) $(TESTOBJMOC) $(LDFLAGS) $(LIBS)

install_bin: $(tmpbin)/gui
	$(INSTALL) $(tmpbin)/gui $(bindir)

message:
	@echo
	@echo "****************************************************************************"
	@echo "****************************************************************************"
	@echo "***"
	@echo "*** Building VisIt's Graphical User Interface ($(tmpbin)/gui)"
	@echo "***"
	@echo "****************************************************************************"
	@echo "****************************************************************************"

moc: $(SRCMOC)

##
## Source file specific rules
##
.h_moc.C:
	$(MOC) $< > $@

main.o: main.C QvisMainWindow.h
	$(CXX) $(CXXFLAGS) $(CPPFLAGS) -c main.C

##
## Automatic dependency stuff
##
@TARGETS@
@LIBTARGETS@
