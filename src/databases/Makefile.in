#                            Copyright 2000 - 2005
#                 The Regents of the University of California.
#                             All rights reserved.
# 
# This work  was produced at the  University of California, Lawrence Livermore
# National Laboratory  (UC LLNL)  under contract no.   W-7405-ENG-48 (Contract
# 48) between  the U.S.  Department  of Energy (DOE)  and  The Regents  of the
# University  of   California (University)   for   the operation  of UC  LLNL.
# Copyright  is reserved  to     the University for   purposes  of  controlled
# dissemination,   commercialization   through   formal licensing,   or  other
# disposition  under  terms  of Contract   48; DOE  policies, regulations  and
# orders;  and U.S.   statutes.  The  rights of   the  Federal Government  are
# reserved under  Contract 48 subject to the  restrictions agreed  upon by DOE
# and University.
# 
#                                 DISCLAIMER
# 
# This software was prepared as an  account of work sponsored  by an agency of
# the United  States Government. Neither the United  States Government nor the
# University of California  nor any  of their  employees, makes any  warranty,
# express or  implied,  or assumes  any  liability  or responsiblity for   the
# accuracy, completeness,  or   usefullness of   any  information,  apparatus,
# product, or process disclosed, or represents that its use would not infringe
# privately   owned  rights. Reference    herein to   any specific  commercial
# products, process, or service   by trade name, trademark,   manufacturer, or
# otherwise,  does not    necessarily  constitute or    imply its endorsement,
# recommendation,  or  favoring by    the  United  States Government  or   the
# University of California. The views and opinions of authors expressed herein
# do not necessarily state or reflect those of the United States Government or
# the University of  California,  and shall not  be  used for  advertising  or
# product endorsement purposes.
#
# Programmer:  Jeremy Meredith
# Date:        August 21, 2002
#
# Modifications:
#
#   Hank Childs, Thu Oct  3 11:01:23 PDT 2002
#   Add a reader for Tetrad.
#
#   Hank Childs, Sun Oct 13 21:23:52 PDT 2002
#   Added a KullLite reader based on work by Akira Haddox.
#
#   Brad Whitlock, Mon Oct 14 16:34:22 PST 2002
#   Added the PDB reader.
#
#   Sean Ahern, Fri Nov 15 15:20:20 PST 2002
#   Added the ability for some databases to be "optional", just like
#   operators.  Not sure this will be used, but...
#
#   Hank Childs, Tue Mar 11 15:48:01 PST 2003
#   Added Spheral++ reader.  Point of contact is Mike Owen.
#
#   Hank Childs, Sat Mar 15 14:18:02 PST 2003
#   Added Points3D reader.  Point of contact is Bill Moran.
#
#   Jeremy Meredith, Tue Apr  8 13:18:29 PDT 2003
#   Added sample readers Rect and Hex.
#
#   Hank Childs, Fri Apr 11 07:25:27 PDT 2003
#   Added Mili reader.
#
#   Hank Childs, Tue Apr 22 16:19:42 PDT 2003
#   Added EnSight reader.
#
#   Jeremy Meredith, Wed May  7 14:00:19 PDT 2003
#   Removed PDB reader.  It should be added to the "PDB" target class
#   if we want it again.
#
#   Hank Childs, Mon May 12 22:36:20 PDT 2003
#   Added BOV reader.
#
#   Akira Haddox, Thu Jun 12 10:12:47 PDT 2003
#   Added Cosmos reader.
#
#   Eric Brugger, Mon Jun 16 12:57:17 PDT 2003
#   Make the building of the BOV reader optional.
#
#   Hank Childs, Tue Jun 17 10:07:15 PDT 2003
#   Do not require that HDF4 be available.  Modified BOV to depend on ZLIB.
#
#   Eric Brugger, Thu Jul  3 17:15:39 PDT 2003
#   Make the building of the BOV reader required.
#
#   Hank Childs, Mon Aug 11 15:51:54 PDT 2003
#   Add PLOT2D.
#
#   Akira Haddox, Fri Aug  8 10:50:10 PDT 2003
#   Added Boxlib2D, Boxlib3D readers.
#
#   Brad Whitlock, Tue Nov 25 13:50:19 PST 2003
#   Added reader for ANALYZE.
#
#   Hank Childs, Mon Nov 24 09:33:18 PST 2003
#   Added Cosmos++.
#
#   Chris Wojtan, Tue Jun 15 15:46:54 PDT 2004
#   Added Image file format reader.
#
#   Hank Childs, Thu Jun 24 12:46:07 PDT 2004
#   Remove Vista from the required format list to the HDF5 list.
#
#   Mark C. Miller, Wed Jul 21 11:19:15 PDT 2004
#   Added Vista back to required format list since it no longer
#   requires HDF5 in order to build. It can now be built with Silo AND HDF5
#   or with Silo only
#
#   Jeremy Meredith, Wed Jul 21 17:44:55 PDT 2004
#   Added OVERFLOW.  It depends on no other libraries.
#
#   Brad Whitlock, Fri Aug 13 14:29:40 PST 2004
#   Added Pixie.
#
#   Jeremy Meredith, Mon Aug 23 14:54:51 PDT 2004
#   Added the Dune plugin.
#
#   Jeremy Meredith, Wed Aug 25 11:56:21 PDT 2004
#   Added SimDB, needed for simulation support.
#
#   Mark C. Miller, Tue Sep 28 19:57:42 PDT 2004
#   Added ViSUS
#
#   Jeremy Meredith, Fri Dec 10 13:39:08 PST 2004
#   Tools are now run directly instead of as an argument to visit.
# 
#   Jeremy Meredith, Wed Nov 17 11:24:23 PST 2004
#   Added TecPlot.
#
#   Brad Whitlock, Fri Dec 17 13:26:46 PST 2004
#   Added CMAT reader.
#
#   Jeremy Meredith, Mon Jan  3 12:46:10 PST 2005
#   Added Enzo reader, which uses HDF4.  At some point it may also use HDF5.
#
#   Hank Childs, Sun Feb 13 13:35:13 PST 2005
#   Added SAR reader (SAR-> Specific Absorption Rate).
#
#   Jeremy Meredith, February 16, 2005
#   Changed captilization of Tecplot.
#
#   Brad Whitlock, Tue Feb 22 19:22:24 PST 2005
#   Added TFT reader.
#
##############################################################################

@SET_MAKE@
@VARIABLES@
all: message
	for dir in $(SUBDIRS); do (cd $$dir && $(MAKE) $@) || exit 1; done

BOXLIB2D=Boxlib2D
BOXLIB3D=Boxlib3D
EXODUS=Exodus TimeVaryingExodus
HDF4=Cosmos Enzo
HDF5=Tetrad SAMRAI CosmosPP Pixie
MILI=Mili
PDB=KullLite PDB
SAF=SAF
SAMPLES=Rect Hex
REQUIRED=ANALYZE BOV CMAT Curve2D Dune EnSight Image Lines OVERFLOW \
 PLOT2D PLOT3D Point3D SAR STL Silo SimDB Spheral TFT Tecplot Vista VTK WavefrontOBJ
VISUS=ViSUS

OPTIONAL=

SUBDIRS=$(REQUIRED) @DB_OPTIONAL_DIRS@ @EXODUS@ @SAF@ @HDF4@ @HDF5@ @PDB@ @MILI@ @BOXLIB2D@ @BOXLIB3D@ @VISUS@
ALLSUBDIRS=$(REQUIRED) $(EXODUS) $(SAF) $(HDF4) $(HDF5) $(MILI) $(PDB) $(BOXLIB2D) $(BOXLIB3D) $(VISUS) $(SAMPLES) $(OPTIONAL)

message:
	@echo
	@echo "****************************************************************************"
	@echo "****************************************************************************"
	@echo "***"
	@echo "*** Building Databases"
	@echo "***"
	@echo "****************************************************************************"
	@echo "****************************************************************************"


dirmakefiles:
	for dir in $(ALLSUBDIRS); do if test -d $$dir; then (cd $$dir && ../../bin/xml2makefile -noprint -clobber $${dir}.xml) || exit 1; fi; done

clean:
	-$(RM) $(LIB)
	for dir in $(SUBDIRS); do (cd $$dir && test ! -f Makefile || $(MAKE) $@) || exit 1; done
	-$(RM) $(CLEAN_FILES)

distclean: clean
	if test -n "$(SUBDIRS)"; then \
		rev=""; for dir in $(SUBDIRS); do rev="$$dir $$rev"; done; \
		for dir in $$rev; do (cd $$dir && test ! -f Makefile || $(MAKE) $@); done \
	fi
	-$(RM) $(DISTCLEAN_FILES) *~ .depend core
	-$(RM) Makefile

depend: dirmakefiles
	for dir in $(SUBDIRS); do (cd $$dir && $(MAKE) $@) || exit 1; done

checkdep: dirmakefiles
	for dir in $(SUBDIRS); do (cd $$dir && $(MAKE) $@) || exit 1; done

