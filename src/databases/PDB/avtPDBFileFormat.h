// ************************************************************************* //
//                           avtPDBFileFormat.h                              //
// ************************************************************************* //

#ifndef AVT_PDB_FILE_FORMAT_H
#define AVT_PDB_FILE_FORMAT_H

#include <avtMTSDFileFormat.h>
#include <PDBFactory.h>

// ****************************************************************************
// Class: avtPDBFileFormat
//
// Purpose:
//   Reads PDB files generated by supported simulation codes.
//
// Notes:      
//
// Programmer: Brad Whitlock
// Creation:   Wed Oct 9 08:01:41 PDT 2002
//
// Modifications:
//   Brad Whitlock, Tue Apr 29 10:50:20 PDT 2003
//   I made it inherit from avtMTSDFileFormat instead of avtSTSDFileFormat.
//
// ****************************************************************************

class avtPDBFileFormat : public avtMTSDFileFormat
{
  public:
                          avtPDBFileFormat(const char * const *, int, bool);
    virtual              ~avtPDBFileFormat();
    
    virtual void          FreeUpResources(void);
    virtual const char   *GetType(void) { return "PDB File Format"; };
    
    virtual void         *GetAuxiliaryData(const char *var,
                                           int timeState,
                                           const char *type,
                                           void *args,
                                           DestructorFunction &);

    virtual void          GetCycles(std::vector<int> &cycles);
    virtual int           GetNTimesteps(void);

    virtual vtkDataSet   *GetMesh(int, const char *);
    virtual vtkDataArray *GetVar(int, const char *);
    virtual vtkDataArray *GetVectorVar(int, const char *);

    virtual void          PopulateDatabaseMetaData(avtDatabaseMetaData *);
    virtual void          PopulateIOInformation(avtIOInformation &);
  protected:
    void       InitializeFactory(int);

    // Data members
    PDBFactory factory;
    bool       initializedFactory;
};

#endif
